<!--
	ioBroker.vis vis-homekittiles Widget-Set
	Copyright 2024 Standarduser
-->
<!-- here you can include so many css as you want -->
<link rel="stylesheet" href="widgets/vis-homekittiles/css/style.css" />
<!-- here you can include so many js-files as you want -->
<script type="text/javascript" src="widgets/vis-homekittiles/js/vis-homekittiles.js"></script>
<script type="text/javascript" src="widgets/vis-homekittiles/js/hkt-datepicker.js"></script>

<!-- the full description of format in data-vis-attrs can be found here:
	https://github.com/ioBroker/ioBroker.vis/blob/master/www/js/visEditInspect.js#L39

	----------------------------------------------------------
	Mandatory XML attributes:
		id="tplHomekittilesWIDGETNAME"
		type="text/ejs"
		class="vis-tpl"

		"type" and "class" are always the same. "id" is unique and must start with "tplSETNAME" and ends with widget name. Use camel-case for it.

	----------------------------------------------------------
	data-vis-attrs - divided with semicolon the list of attributes, like attr1/id;attr2/color
		Full format of one attribute is: attr_name(start-end)[default_value]/type,idFilter/onChangeFunc
			attr_name - the name of the attribute, e.g. "myID"
			start-end - creates automatically attributes from attr_namestart to attr_nameend, like "myID(1-3)" creates myID1, myID2, myID3
			default_value - by creation of widget this attribute will be filled with this value, e.g. "myID[#001122]/color"
			type - some predefined types have edit helpers, else it will be shown as text field

				Type format:
					hid
					checkbox
					image - image
					number,min,max,step - non-float number. min,max,step are optional
					dimension - text input with button for px or %
					color - color picker
					views - Name of the view
					effect - jquery UI show/hide effects
					eff_opt - additional option to effect slide (up, down, left, right)
					fontname - Font name
					slider,min,max,step - Default step is ((max - min) / 100)
					select,value1,value2,... - dropdown select
					nselect,value1,value2,... - same as select, but without translation of items
					auto,value1,value2,... - autocomplete
					style,fileFilter,nameFilter,attrFilter
					custom,functionName,options,... - custom editor - functionName is starting from vis.binds.[widgetset.funct]. E.g. custom/timeAndWeather.editWeather,short
					group.name - define new or old group. All following attributes belongs to new group till new group.xyz
					group.name/byindex/icon - like group, but all following attributes will be grouped by ID. Icon is optional. Like group.windows/byindex;slide(1-4)/id;slide_type(1-4)/select,open,closed  Following groups will be created Windows1(slide1,slide_type1), Windows2(slide2,slide_type2), Windows3(slide3,slide_type3), Windows4(slide4,slide_type4)
					text - dialog box with html editor
					html - dialog box with html editor
					widget - existing widget selector
					history - select history instances
					password - password

				If type is "id", you can define filer for "Select ID Dialog", like "myID/id,level.temperature".
				Additionally you can define callback(onChangeFunc), which will be called if this attribute was changed by user for different purposes: validate entry, fill other attributes, ...

		You can define additional data-vis-attrs line: data-vis-attrs0, data-vis-attrs1. Anyway data-vis-attrs must be there. You may not skip numbers.
		E.g. in "data-vis-attrs="A;" data-vis-attrs1="B" attribute B will be not parsed.

	--------------------------------------------------------
	data-vis-type
		Help information for user. Used for search.
		You can define more than one type divided by comma.
		There are following common types, but you can use your own specific types:
			ctrl   - widget that can write some Object IDs
			val    - widget that shows some information from Object IDs
			static - widget do not read information from Object IDs or URL
			button - button widget
			dimmer - dimmer widget
			weather - weather widget
			...

	--------------------------------------------------------
	data-vis-set
		Name of the widget set. Must be equal to the name of this HTML file

	--------------------------------------------------------
	data-vis-prev
		Html code used as preview of this widget. If widget is complex you can just use image as preview:
		data-vis-prev='<img src="widgets/hqwidgets/img/prev/Prev_tplHomekittilesShowInstance.png"></img>'
		Of course the image must exist.

	--------------------------------------------------------
	data-vis-name
		Readable name of widget shown in vis editor.

	--------------------------------------------------------
	data-vis-beta="true"
		Shows "BETA" symbol in vis editor by preview

	--------------------------------------------------------
	data-vis-update-style="true"
		Call redraw of widget if some of the CSS styles in editor for this widget was changed

	You can read about Magic tags here: http://canjs.com/guides/EJS.html
	Following magic tags are exist:
	<% %> - execute javascript
	<%= %> - place escaped result to HTML document
	<%== %> - place unescaped result to HTML document

You can do "if" conditions and "for" cycles.

-->

<script id="tpHomekittilesLabel"
		type="text/ejs"
		class="vis-tpl"
		data-vis-set="vis-homekittiles"
		data-vis-update-style="true"
		data-vis-type="static"
		data-vis-name="hkt-Label"
		data-vis-prev='<div id="prev_tplHomekittilesNotification" style="position: relative;">
			<div class="homekitTiles label headline1">Headline 1</div>
			<div class="homekitTiles label headline2">Headline 2</div>
			<div class="homekitTiles label headline3">Headline 3</div>
			<div class="homekitTiles label textlabel">Text/Label</div>
			<div class="homekitTiles label smalllabel">Small label</div>'
		data-vis-attrs="description/custom,vis-homekittiles.infoText,hktLabel;text/text;textstyle[textlabel]/select,headline1,headline2,headline3,textlabel,smalllabel;"
>
	<div class="homekitTiles label <%== this.data.attr('textstyle') %> vis-widget <%== this.data.attr('class') %>" style="width:200px; height:<%= this.data.attr('textstyle') == 'headline1' ? '28' : this.data.attr('textstyle') == 'headline2' ? '18' : this.data.attr('textstyle') == 'headline3' ? '14' : this.data.attr('textstyle') == 'textlabel' ? '18' : this.data.attr('textstyle') == 'smalllabel' ? '14' : '20' %>px;" id="<%= this.data.attr('wid') %>">
		<div class="vis-widget-body">
			<%== this.data.attr('text') %>
		</div>
	</div>
</script>

<script id="tplHomekittilesNotification"
	type="text/ejs"
	class="vis-tpl"
	data-vis-set="vis-homekittiles"
	data-vis-update-style="true"
	data-vis-type="val"
	data-vis-name="hkt-Notification"
	data-vis-prev='<div id="prev_tplHomekittilesNotification" style="position: relative;">
						<div class="vis-widget_prev" style="width: 110px; height: 110px; font-size:10px; font-weight: normal;">
							<div class="homekitTiles vis-widget-prev-body notification" style="top: 50px; position: absolute;">
								<span class="notification1">1</span>
								<span class="notification2">2</span>
								<span class="notification3">3</span>
								<span class="notification4">4</span>
								<span class="notification5">5</span>
							</div>
						</div>
					</div>'
	data-vis-attrs="description/custom,vis-homekittiles.infoText,hktNotification;
					notification1oid/id;
					notification2oid/id;
					notification3oid/id;
					notification4oid/id;
					notification5oid/id;
					notification1showZero/checkbox;
					notification2showZero/checkbox;
					notification3showZero/checkbox;
					notification4showZero/checkbox;
					notification5showZero/checkbox;"
>
	<div class="homekitTiles notification vis-widget <%== this.data.attr('class') %>" style="width:85px; height:21px;" id="<%= this.data.attr('wid') %>">
		<div class="vis-widget-body">
			<div class="notification" data-oid="<%= this.data.attr('notification1oid') %>">
				<%
				valNotification1 = vis.states.attr(this.data['notification1oid'] + '.val');
				if (valNotification1 === undefined || valNotification1 === '') valNotification1 = 0;

				if (vis.editMode || valNotification1 !== 0 && valNotification1 !== '0' || (valNotification1 == 0 || valNotification1 == '0') && this.data.attr('notification1showZero')) { %>
					<span class="notification1" ><%=valNotification1%></span>
				<% } %>
			</div>
			<div class="notification" data-oid="<%= this.data.attr('notification2oid') %>">
				<%
				valNotification2 = vis.states.attr(this.data['notification2oid'] + '.val');
				if (valNotification2 === undefined || valNotification2 === '') valNotification2 = 0;

				if (vis.editMode || valNotification2 !== 0 && valNotification2 !== '0' || (valNotification2 == 0 || valNotification2 == '0') && this.data.attr('notification2showZero')) { %>
					<span class="notification2" ><%=valNotification2%></span>
				<% } %>
			</div>
			<div class="notification" data-oid="<%= this.data.attr('notification3oid') %>">
				<%
				valNotification3 = vis.states.attr(this.data['notification3oid'] + '.val');
				if (valNotification3 === undefined || valNotification3 === '') valNotification3 = 0;

				if (vis.editMode || valNotification3 !== 0 && valNotification3 !== '0' || (valNotification3 == 0 || valNotification3 == '0') && this.data.attr('notification3showZero')) { %>
					<span class="notification3" ><%=valNotification3%></span>
				<% } %>
			</div>
			<div class="notification" data-oid="<%= this.data.attr('notification4oid') %>">
				<%
				valNotification4 = vis.states.attr(this.data['notification4oid'] + '.val');
				if (valNotification4 === undefined || valNotification4 === '') valNotification4 = 0;

				if (vis.editMode || valNotification4 !== 0 && valNotification4 !== '0' || (valNotification4 == 0 || valNotification4 == '0') && this.data.attr('notification4showZero')) { %>
					<span class="notification4" ><%=valNotification4%></span>
				<% } %>
			</div>
			<div class="notification" data-oid="<%= this.data.attr('notification5oid') %>">
				<%
				valNotification5 = vis.states.attr(this.data['notification5oid'] + '.val');
				if (valNotification5 === undefined || valNotification5 === '') valNotification5 = 0;

				if (vis.editMode || valNotification5 !== 0 && valNotification5 !== '0' || (valNotification5 == 0 || valNotification5 == '0') && this.data.attr('notification5showZero')) { %>
					<span class="notification5" ><%=valNotification5%></span>
				<% } %>
			</div>
		</div>
	</div>
</script>

<script id="tplHomekittilesRadiobuttons"
	type="text/ejs"
	class="vis-tpl"
	data-vis-set="vis-homekittiles"
	data-vis-update-style="true"
	data-vis-type="ctrl"
	data-vis-name="hkt-Radiobuttons"
	data-vis-prev='<div id="prev_tplHomekittilesRadiobuttons" style=" position: relative;">
						<div class="homekitTiles radiobuttons vis-widget_prev" style="width: 55px; height: 110px; font-size:10px; font-weight: normal;">
							<div class="vis-widget-prev-body">
								<div class="radiobuttons">
									<div class="radiobuttonGroup vertical">
										<div class="radiobutton">
											<label>Ein</label>
										</div>
										<div class="radiobutton">
											<label>Aus</label>
										</div>
										<div class="radiobutton state-active" style="border-radius: 0 0 15px 15px">
											<label>Auto</label>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>'
	data-vis-attrs="description/custom,vis-homekittiles.infoText,hktRadiobuttons;oid;numberOfButtons[3]/slider,2,10,1;directionHorizontal/checkbox;"
	data-vis-attrs0="group.buttons;valueButton_(1-numberOfButtons);labelButton_(1-numberOfButtons)[Button];iconButton_(1-numberOfButtons)/image;"
	data-vis-attrs1="group.blockOperation;blockOperationIfTrue/checkbox;blockOperationIfFalse/checkbox;blockOperationShowIcon/checkbox;blockOperationIcon/image;blockOperationIconNotInEditor/checkbox;blockOperationUseDifferentOID/checkbox;oidBlockOperation/id;"
	data-vis-attrs2="group.acknowledge;ackShowIcon/checkbox;ackIcon/image;ackUseSpin/checkbox;ackInvertFunction/checkbox;ackIconNotInEditor/checkbox;"
>
	<div class="homekitTiles radiobuttons vis-widget <%== this.data.attr('class') %>" style="width:110px; height:235px;" id="<%= this.data.attr('wid') %>">
		<div class="vis-widget-body">
			<div class="radiobuttons" id="<%= this.data.attr('wid') %>_radio" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> setTimeout(function () {vis.binds['vis-homekittiles'].radio(el)}, 100) %> <%= (el) -> vis.binds.basic._onChange(el); %>>
				<div class="radiobuttonGroup <%= this.data.attr('directionHorizontal') ? 'horizontal' : 'vertical' %>">

					<%
					var ackShowIcon = this.data.attr('ackShowIcon');
					var ackInvertFunction = this.data.attr('ackInvertFunction');

					var numberOfButtons = Number(this.data.attr("numberOfButtons"));
					var wid = data.attr('wid');
					var i = 1;

					while (i <= numberOfButtons) {
						var icon = this.data.attr('iconButton_' + i);
						var value = this.data.attr('valueButton_' + i);
						var text = this.data.attr('labelButton_' + i);

						%>
						<div class="radiobutton">
							<input type="radio" id="<%= wid %>_radio<%= i %>" name="<%= wid %>_radio" value="<%= value %>" />
							<label for="<%= wid %>_radio<%= i %>">
								<% if (icon !== '' && icon !== undefined) { %>
									<div class="radioIcon"><img <%= icon ? 'src=' + icon : '' %> /></div>
								<% } %>
								<span><%== text %></span>

								<div class="ackIcon" <%= (el) -> vis.binds['vis-homekittiles'].addAckIcon(el, data) %>></div>
							</label>
							<div class="blockOperation" <%= (el) -> vis.binds['vis-homekittiles'].addBlockOperation(el, data) %>></div>
						</div>
						<%

						i++;
					}
					%>

				</div>
			</div>
		</div>
	</div>
</script>

<script id="tplHomekittilesDatepicker"
	type="text/ejs"
	class="vis-tpl"
	data-vis-set="vis-homekittiles"
	data-vis-update-style="true"
	data-vis-name="hkt-Datepicker"
	data-vis-prev='<div id="prev_tplHomekittilesValue" style="position: relative;">
						<div class="vis-widget_prev" style="width: 110px; height: 110px; font-size:10px; font-weight: normal;">
							<div class="homekitTiles tile vis-widget-prev-body state-default">
								<span class="tileValue" style="background-color: unset; font-size: 30px;">ðŸ“…</span>
								<label class="labelGroup1">Datum<br>2023-07-31</label>
							</div>
						</div>
					</div>'
	data-vis-attrs="description/custom,vis-homekittiles.infoText,hktDatepicker;oid/id;icon/image;iconRound/checkbox;showLikeActive[true]/checkbox;"
	data-vis-attrs0="group.labelGroup1;label[Datepicker];dateformat[dd.mm.yy]/select,dd.mm.yy,yy-mm-dd;"
	data-vis-attrs1="group.labelGroup2;label3pre;label3oid/id;label3unit;label3post;label3decimals[1];label3factor[1];label3comma[true]/checkbox;label3tdp/checkbox;label4pre;label4oid/id;label4unit;label4post;label4decimals[1];label4factor[1];label4comma[true]/checkbox;label4tdp/checkbox;label5pre;label5oid/id;label5unit;label5post;label5decimals[1];label5factor[1];label5comma[true]/checkbox;label5tdp/checkbox;"
	data-vis-attrs2="group.increment;oidIncrement/id;incrementPlusShow/checkbox;incrementMinusShow/checkbox;incrementPlusValue[1];incrementMinusValue[-1];incrementValueMax[100];incrementValueMin[0];incrementShowOnlyIfTrue/checkbox;"
	data-vis-attrs3="group.blockOperation;blockOperationIfTrue/checkbox;blockOperationIfFalse/checkbox;blockOperationShowIcon/checkbox;blockOperationIcon/image;blockOperationIconNotInEditor/checkbox;blockOperationUseDifferentOID/checkbox;oidBlockOperation/id;"
	data-vis-attrs4="group.acknowledge;ackShowIcon/checkbox;ackIcon/image;ackUseSpin/checkbox;ackInvertFunction/checkbox;ackIconNotInEditor/checkbox;"
	data-vis-attrs5="group.signalpics;numberOfSignals[1]/slider,3,10,1;"
	data-vis-attrs6="group.signals/byindex;oidSignal(1-numberOfSignals)/id;signalComparison(1-numberOfSignals)/select,comparisonEqual,comparisonNotEqual,comparisonLowerEqual,comparisonGreaterEqual,comparisonLower,comparisonGreater;signalCompValue(1-numberOfSignals);signalIcon(1-numberOfSignals)/image;signalDescription(1-numberOfSignals);"
>
	<div class="homekitTiles tile datepicker vis-widget <%= this.data.attr('showLikeActive') ? 'state-active' : 'state-default' %> <%== this.data.attr('class') %>" style="width: 110px; height: 110px;" id="<%= this.data.attr('wid') %>">
		<div class="vis-widget-body">
			<div class="tileIcon" <%= (el) -> vis.binds['vis-homekittiles'].addButtonIcon(el, data) %>></div>
			<label class="labelGroup1">
				<%= this.data.attr('label') %>
			</label>
			<div class="labelGroup2" <%= (el) -> vis.binds['vis-homekittiles'].addLabelGroup2(el, data) %>></div>

			<input
				type="text"
				name="<%= this.data.attr('wid') %>_input"
				id="<%= this.data.attr('wid') %>_input"
				value=""
				readonly
				data-oid="<%= this.data.attr('oid') %>"
				data-dateformat="<%= this.data.attr('dateformat') %>"
				<%= (el) -> vis.binds['vis-homekittiles'].hktDatepicker(el); %>
			/>
		</div>

		<div class="ackIcon" <%= (el) -> vis.binds['vis-homekittiles'].addAckIcon(el, data) %>></div>
		<div class="increment" <%= (el) -> vis.binds['vis-homekittiles'].addIncrement(el, data) %>></div>
		<div class="blockOperation" <%= (el) -> vis.binds['vis-homekittiles'].addBlockOperation(el, data) %>></div>
		<div class="signals"><% for (let i = 1; i <= Number(this.data.attr("numberOfSignals")); i++) { %><div class="signal<%= i %>" data-oid="<%= this.data.attr('oidSignal' + i) %>" data-compOp="<%= this.data.attr('signalComparison' + i) %>" data-compVal="<%= this.data.attr('signalCompValue' + i) %>" data-icon="<%= this.data.attr('signalIcon' + i) %>" data-desc="<%= this.data.attr('signalDescription' + i) %>" <%= (el) -> vis.binds['vis-homekittiles'].addSignalIcon(el) %>></div><% } %></div>
	</div>
</script>

<script id="tplHomekittilesSwitchBool"
	type="text/ejs"
	class="vis-tpl"
	data-vis-set="vis-homekittiles"
	data-vis-update-style="true"
	data-vis-type="ctrl"
	data-vis-name="hkt-Switch-Bool"
	data-vis-prev='<div id="prev_tplHomekittilesSwitchBool" style="position: relative;">
						<div class="vis-widget_prev" style="width: 110px; height: 110px; font-size:10px; font-weight: normal;">
							<div class="homekitTiles tile vis-widget-prev-body state-active">
								<span class="tileValue" style="background-color: unset; font-size: 30px;">ðŸ’¡</span>
								<label class="labelGroup1">Switch</label>
							</div>
						</div>
					</div>'
	data-vis-attrs="description/custom,vis-homekittiles.infoText,hktSwitchBool;oid/id;icon/image;iconRound/checkbox;"
	data-vis-attrs0="group.labelGroup1;label[Switch];label2pre;label2oid/id;label2unit;label2post;label2decimals[1];label2factor[1];label2comma[true]/checkbox;label2tdp/checkbox;"
	data-vis-attrs1="group.labelGroup2;label3pre;label3oid/id;label3unit;label3post;label3decimals[1];label3factor[1];label3comma[true]/checkbox;label3tdp/checkbox;label4pre;label4oid/id;label4unit;label4post;label4decimals[1];label4factor[1];label4comma[true]/checkbox;label4tdp/checkbox;label5pre;label5oid/id;label5unit;label5post;label5decimals[1];label5factor[1];label5comma[true]/checkbox;label5tdp/checkbox;"
	data-vis-attrs2="group.increment;oidIncrement/id;incrementPlusShow/checkbox;incrementMinusShow/checkbox;incrementPlusValue[1];incrementMinusValue[-1];incrementValueMax[100];incrementValueMin[0];incrementShowOnlyIfTrue/checkbox;"
	data-vis-attrs3="group.blockOperation;blockOperationIfTrue/checkbox;blockOperationIfFalse/checkbox;blockOperationShowIcon/checkbox;blockOperationIcon/image;blockOperationIconNotInEditor/checkbox;blockOperationUseDifferentOID/checkbox;oidBlockOperation/id;"
	data-vis-attrs4="group.acknowledge;ackShowIcon/checkbox;ackIcon/image;ackUseSpin/checkbox;ackInvertFunction/checkbox;ackIconNotInEditor/checkbox;"
	data-vis-attrs5="group.signalpics;numberOfSignals[1]/slider,3,10,1;"
	data-vis-attrs6="group.signals/byindex;oidSignal(1-numberOfSignals)/id;signalComparison(1-numberOfSignals)/select,comparisonEqual,comparisonNotEqual,comparisonLowerEqual,comparisonGreaterEqual,comparisonLower,comparisonGreater;signalCompValue(1-numberOfSignals);signalIcon(1-numberOfSignals)/image;signalDescription(1-numberOfSignals);"
>
	<div class="homekitTiles tile vis-widget <%= vis.states.attr(this.data['oid'] + '.val') ? 'state-active' : 'state-default' %> <%== this.data.attr('class') %>" style="width:110px; height:110px;" id="<%= this.data.attr('wid') %>">
		<div class="vis-widget-body" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.toggle(el); %>>
			<div class="tileIcon" <%= (el) -> vis.binds['vis-homekittiles'].addButtonIcon(el, data) %>></div>
			<div class="labelGroup1" <%= (el) -> vis.binds['vis-homekittiles'].addLabelGroup1(el, data) %>></div>
			<div class="labelGroup2" <%= (el) -> vis.binds['vis-homekittiles'].addLabelGroup2(el, data) %>></div>
		</div>

		<div class="ackIcon" <%= (el) -> vis.binds['vis-homekittiles'].addAckIcon(el, data) %>></div>
		<div class="increment" <%= (el) -> vis.binds['vis-homekittiles'].addIncrement(el, data) %>></div>
		<div class="blockOperation" <%= (el) -> vis.binds['vis-homekittiles'].addBlockOperation(el, data) %>></div>
		<div class="signals"><% for (let i = 1; i <= Number(this.data.attr("numberOfSignals")); i++) { %><div class="signal<%= i %>" data-oid="<%= this.data.attr('oidSignal' + i) %>" data-compOp="<%= this.data.attr('signalComparison' + i) %>" data-compVal="<%= this.data.attr('signalCompValue' + i) %>" data-icon="<%= this.data.attr('signalIcon' + i) %>" data-desc="<%= this.data.attr('signalDescription' + i) %>" <%= (el) -> vis.binds['vis-homekittiles'].addSignalIcon(el) %>></div><% } %></div>
	</div>
</script>

<script id="tplHomekittilesValue"
	type="text/ejs"
	class="vis-tpl"
	data-vis-set="vis-homekittiles"
	data-vis-update-style="true"
	data-vis-type="ctrl"
	data-vis-name="hkt-Value"
	data-vis-prev='<div id="prev_tplHomekittilesValue" style="position: relative;">
						<div class="vis-widget_prev" style="width: 110px; height: 110px; font-size:10px; font-weight: normal;">
							<div class="homekitTiles tile vis-widget-prev-body state-active">
								<span class="tileValue">22Â°</span>
								<label class="labelGroup1">Value</label>
							</div>
						</div>
					</div>'
	data-vis-attrs="description/custom,vis-homekittiles.infoText,hktValue;oid/id;unit;decimals[1];factor[1];comma[true]/checkbox;tdp/checkbox;oidActive/id;showLikeActive[true]/checkbox;"
	data-vis-attrs0="group.labelGroup1;label[Value];label2pre;label2oid/id;label2unit;label2post;label2decimals[1];label2factor[1];label2comma[true]/checkbox;label2tdp/checkbox;"
	data-vis-attrs1="group.labelGroup2;label3pre;label3oid/id;label3unit;label3post;label3decimals[1];label3factor[1];label3comma[true]/checkbox;label3tdp/checkbox;label4pre;label4oid/id;label4unit;label4post;label4decimals[1];label4factor[1];label4comma[true]/checkbox;label4tdp/checkbox;label5pre;label5oid/id;label5unit;label5post;label5decimals[1];label5factor[1];label5comma[true]/checkbox;label5tdp/checkbox;"
	data-vis-attrs2="group.increment;oidIncrement/id;incrementPlusShow/checkbox;incrementMinusShow/checkbox;incrementPlusValue[1];incrementMinusValue[-1];incrementValueMax[100];incrementValueMin[0];"
	data-vis-attrs3="group.signalpics;numberOfSignals[1]/slider,3,10,1;"
	data-vis-attrs4="group.signals/byindex;oidSignal(1-numberOfSignals)/id;signalComparison(1-numberOfSignals)/select,comparisonEqual,comparisonNotEqual,comparisonLowerEqual,comparisonGreaterEqual,comparisonLower,comparisonGreater;signalCompValue(1-numberOfSignals);signalIcon(1-numberOfSignals)/image;signalDescription(1-numberOfSignals);"
>
	<div class="homekitTiles tile vis-widget <%= this.data.attr('showLikeActive') ? 'state-active' : vis.states.attr(this.data['oidActive'] + '.val') ? 'state-active' : 'state-default' %> <%== this.data.attr('class') %>" style="width:110px; height:110px;" id="<%= this.data.attr('wid') %>">
		<div class="vis-widget-body" data-oid="<%= this.data.attr('oid') %>">
			<span class="tileValue"><%= vis.binds['vis-homekittiles'].formatValue(vis.states.attr(data.oid + '.val'), this.data.attr('decimals'), this.data.attr('factor'), this.data.attr('comma'), this.data.attr('tdp')) %><%= this.data.attr('unit') %></span>
			<div class="labelGroup1" <%= (el) -> vis.binds['vis-homekittiles'].addLabelGroup1(el, data) %>></div>
			<div class="labelGroup2" <%= (el) -> vis.binds['vis-homekittiles'].addLabelGroup2(el, data) %>></div>
		</div>

		<div class="ackIcon" <%= (el) -> vis.binds['vis-homekittiles'].addAckIcon(el, data) %>></div>
		<div class="increment" <%= (el) -> vis.binds['vis-homekittiles'].addIncrement(el, data) %>></div>
		<div class="signals"><% for (let i = 1; i <= Number(this.data.attr("numberOfSignals")); i++) { %><div class="signal<%= i %>" data-oid="<%= this.data.attr('oidSignal' + i) %>" data-compOp="<%= this.data.attr('signalComparison' + i) %>" data-compVal="<%= this.data.attr('signalCompValue' + i) %>" data-icon="<%= this.data.attr('signalIcon' + i) %>" data-desc="<%= this.data.attr('signalDescription' + i) %>" <%= (el) -> vis.binds['vis-homekittiles'].addSignalIcon(el) %>></div><% } %></div>
	</div>
</script>

<script id="tplHomekittilesViewInWidgetDialog"
	type="text/ejs"
	class="vis-tpl"
	data-vis-set="vis-homekittiles"
	data-vis-update-style="true"
	data-vis-type="container,dialog"
	data-vis-name="hkt-ViewInWidget-Dialog"
	data-vis-prev='<div id="prev_tplHomekittilesViewInWidgetDialog" style="position: relative;">
						<div class="vis-widget_prev" style="width: 110px; height: 110px; font-size:10px; font-weight: normal;">
							<div class="homekitTiles tile vis-widget-prev-body state-default">
								<span class="tileValue" style="background-color: unset; font-size: 30px;">ðŸ’¬</span>
								<label class="labelGroup1">Dialog</label>
							</div>
						</div>
					</div>'
	data-vis-attrs="description/custom,vis-homekittiles.infoText,hktViewInWidgetDialog;oidActive/id;icon/image;iconRound/checkbox;showLikeActive/checkbox;"
	data-vis-attrs0="group.labelGroup1;label[Dialog];label2pre;label2oid/id;label2unit;label2post;label2decimals[1];label2factor[1];label2comma[true]/checkbox;label2tdp/checkbox;"
	data-vis-attrs1="group.labelGroup2;label3pre;label3oid/id;label3unit;label3post;label3decimals[1];label3factor[1];label3comma[true]/checkbox;label3tdp/checkbox;label4pre;label4oid/id;label4unit;label4post;label4decimals[1];label4factor[1];label4comma[true]/checkbox;label4tdp/checkbox;label5pre;label5oid/id;label5unit;label5post;label5decimals[1];label5factor[1];label5comma[true]/checkbox;label5tdp/checkbox;"
	data-vis-attrs2="group.increment;oidIncrement/id;incrementPlusShow/checkbox;incrementMinusShow/checkbox;incrementPlusValue[1];incrementMinusValue[-1];incrementValueMax[100];incrementValueMin[0];incrementShowOnlyIfTrue/checkbox;"
	data-vis-attrs3="group.blockOperation;blockOperationIfTrue/checkbox;blockOperationIfFalse/checkbox;blockOperationShowIcon/checkbox;blockOperationIcon/image;blockOperationIconNotInEditor/checkbox;blockOperationUseDifferentOID/checkbox;oidBlockOperation/id;"
	data-vis-attrs4="group.dialog;contains_view/views;title;autoclose/slider,0,30000,100;modal/checkbox;dialog_width;dialog_height;dialog_top;dialog_left;overflowX/nselect,,visible,hidden,scroll,auto,initial,inherit;overflowY/nselect,,visible,hidden,scroll,auto,initial,inherit;arrowDirection/nselect,,top,right,bottom,left;setIdOnOpenClose/id;setValueOnOpen;setValueOnClose;"
	data-vis-attrs5="group.signalpics;numberOfSignals[1]/slider,3,10,1;"
	data-vis-attrs6="group.signals/byindex;oidSignal(1-numberOfSignals)/id;signalComparison(1-numberOfSignals)/select,comparisonEqual,comparisonNotEqual,comparisonLowerEqual,comparisonGreaterEqual,comparisonLower,comparisonGreater;signalCompValue(1-numberOfSignals);signalIcon(1-numberOfSignals)/image;signalDescription(1-numberOfSignals);"
>
	<div class="homekitTiles tile dialog vis-widget <%= this.data.attr('showLikeActive') ? 'state-active' : vis.states.attr(this.data['oidActive'] + '.val') ? 'state-active' : 'state-default' %> <%== this.data.attr('class') %>" style="width: 110px; height: 110px;" id="<%= this.data.attr('wid') %>">
		<div class="vis-widget-body" id="<%= this.data.attr('wid') %>_body">
			<div class="tileIcon" <%= (el) -> vis.binds['vis-homekittiles'].addButtonIcon(el, data) %>></div>
			<div class="labelGroup1" <%= (el) -> vis.binds['vis-homekittiles'].addLabelGroup1(el, data) %>></div>
			<div class="labelGroup2" <%= (el) -> vis.binds['vis-homekittiles'].addLabelGroup2(el, data) %>></div>
		</div>

		<div class="vis-widget-dialog <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>_dialog" style="display:none" title="<%= this.data.attr('title') %>">
			<div data-vis-contains="<%= this.data.attr('contains_view') %>" class="vis-widget-body vis-view-container"></div>
		</div>

		<div class="increment" <%= (el) -> vis.binds['vis-homekittiles'].addIncrement(el, data) %>></div>
		<div class="blockOperation" <%= (el) -> vis.binds['vis-homekittiles'].addBlockOperation(el, data) %>></div>
		<div class="signals"><% for (let i = 1; i <= Number(this.data.attr("numberOfSignals")); i++) { %><div class="signal<%= i %>" data-oid="<%= this.data.attr('oidSignal' + i) %>" data-compOp="<%= this.data.attr('signalComparison' + i) %>" data-compVal="<%= this.data.attr('signalCompValue' + i) %>" data-icon="<%= this.data.attr('signalIcon' + i) %>" data-desc="<%= this.data.attr('signalDescription' + i) %>" <%= (el) -> vis.binds['vis-homekittiles'].addSignalIcon(el) %>></div><% } %></div>

		<div class="popup-helper" <%= (el) -> vis.binds['vis-homekittiles'].dialogContainer(el, data) %> />
		<div class="popup-helper" <%= (el) -> vis.binds.jqueryui.dialogAutoClose(el, data.attr('autoclose')) %> />
	</div>
</script>

<script id="tplHomekittilesThermostatDialog"

		type="text/ejs"
		class="vis-tpl"
		data-vis-set="vis-homekittiles"
		data-vis-update-style="true"
		data-vis-type="static,dialog"
		data-vis-name="hkt-Thermostat-Dialog"
		data-vis-prev='<div id="prev_tplHomekittilesValue" style="position: relative;">
							<div class="vis-widget_prev" style="width: 110px; height: 110px; font-size:10px; font-weight: normal;">
								<div class="homekitTiles tile vis-widget-prev-body state-active">
									<span class="tileValue">22Â°</span>
									<label class="labelGroup1">Thermostat-Dialog</label>
								</div>
							</div>
						</div>'
		data-vis-attrs="description/custom,vis-homekittiles.infoText,hktThermostatDialog;
						autofillOids[true]/checkbox;
						oidActualTemperature/id/autofillThermostat(onChangeFunc);
						oidSetPointTemperature/id;
						oidSetPointMode/id;
						oidHumidity/id;
						oidActiveProfile/id;
						oidLowBat/id;
						oidUnreach/id;
						oidWindowState/id;
						unitTemperature[Â°];
						unitHumidity[% r.F.];
						temperatureMin[15];
						temperatureMax[28];
						temperatureStep[0.5];
						comma[true]/checkbox;
						showLikeActive[true]/checkbox;
						texttemplate[-]/select,-,english,german/texttemplateThermostat(onChangeFunc);
						imgLowBat/image;
						imgUnreach/image;"
		data-vis-attrs0="group.label;label[Thermostat];label2pre[Set at];label2post[];"
		data-vis-attrs1="group.blockOperation;blockOperationIfTrue/checkbox;blockOperationIfFalse/checkbox;blockOperationShowIcon/checkbox;blockOperationIcon/image;blockOperationIconNotInEditor/checkbox;blockOperationUseDifferentOID/checkbox;blockOperationOID/id;"
		data-vis-attrs2="group.thermostatDialog;title;closebuttonLabel;actualTemperatureLabel;setpointTemperatureLabel;setpointModeLabel;setpointModeValues;setpointModeTexts;setpointModeOperable/checkbox;actualHumidityLabel;activeProfileLabel;activeProfileValues;activeProfileTexts;windowStateLabel;windowStateValues;windowStateTexts;lowBatLabel;unreachLabel;autoclose/slider,0,30000,100;modal/checkbox;dialog_top;dialog_left;arrowDirection/nselect,,top,right,bottom,left;"
		data-vis-attrs3="group.signalpics;numberOfSignals[1]/slider,3,10,1;"
		data-vis-attrs4="group.signals/byindex;oidSignal(1-numberOfSignals)/id;signalComparison(1-numberOfSignals)/select,comparisonEqual,comparisonNotEqual,comparisonLowerEqual,comparisonGreaterEqual,comparisonLower,comparisonGreater;signalCompValue(1-numberOfSignals);signalIcon(1-numberOfSignals)/image;signalDescription(1-numberOfSignals);"
>
	<div class="homekitTiles tile thermostatDialog vis-widget <%= this.data.attr('showLikeActive') ? 'state-active' : 'state-default' %> <%== this.data.attr('class') %>" style="width: 110px; height: 110px;" id="<%= this.data.attr('wid') %>">
		<div class="vis-widget-body" id="<%= this.data.attr('wid') %>_body">

			<span class="tileValue <%= vis.states.attr(this.data['oidActualTemperature'] + '.val') < vis.states.attr(this.data['oidSetPointTemperature'] + '.val') ? 'heating' : vis.states.attr(this.data['oidActualTemperature'] + '.val') > vis.states.attr(this.data['oidSetPointTemperature'] + '.val') ? 'cooling' : '' %>"><%= vis.binds['vis-homekittiles'].formatValue(vis.states.attr(this.data['oidActualTemperature'] + '.val'), undefined, 1, this.data.attr('comma'), false) %><%= this.data.attr('unitTemperature') %></span>
			<div class="labelGroup1">
				<span class="label"><%= this.data.attr('label') %></span>
				<% if (this.data.attr('oidSetPointTemperature')) { %>
					<br>
					<span class="label2pre"><%= this.data.attr('label2pre') %></span>
					<span class="label2value"><%= vis.binds['vis-homekittiles'].formatValue(vis.states.attr(this.data['oidSetPointTemperature'] + '.val'), undefined, 1, this.data.attr('comma'), false) %></span><span class="label2unit"><%= this.data.attr('unitTemperature') %></span>
					<span class="label2post"><%= this.data.attr('label2post') %></span>
				<% } %>
			</div>

			<% if (vis.states.attr(this.data['oidUnreach'] + '.val')) { %>
				<% if (this.data['imgUnreach']) { %>
					<div class="signals">
						<div class="signal unreach" data-oid="<%= this.data.attr('oidUnreach') %>" data-compOp="comparisonEqual" data-compVal="true" data-icon="<%= this.data.attr('imgUnreach') %>" data-desc="<%= this.data.attr('unreachLabel') %>" <%= (el) -> vis.binds['vis-homekittiles'].addSignalIcon(el) %>></div>
					</div>
				<% } else { %>
					<span class="label3value unreach error">UNREACH</span>
				<% } %>
			<% } else if (vis.states.attr(this.data['oidLowBat'] + '.val')) { %>
				<% if (this.data['imgLowBat']) { %>
					<div class="signals">
						<div class="signal lowbat" data-oid="<%= this.data.attr('oidLowBat') %>" data-compOp="comparisonEqual" data-compVal="true" data-icon="<%= this.data.attr('imgLowBat') %>" data-desc="<%= this.data.attr('lowBatLabel') %>" <%= (el) -> vis.binds['vis-homekittiles'].addSignalIcon(el) %>></div>
					</div>
				<% } else { %>
					<span class="label3value lowbat warn">LOWBAT</span>
				<% } %>
			<% } else { %>
				<div class="labelGroup2">
					<% if (this.data.attr('oidHumidity')) { %>
						<span class="label3value"><%= vis.states.attr(this.data['oidHumidity'] + '.val') %><%= this.data.attr('unitHumidity') %></span><br>
					<% } %>
					<% if (this.data.attr('oidActiveProfile')) {
						var activeProfile = vis.states.attr(this.data['oidActiveProfile'] + '.val').toString();
						var activeProfileValue = (data.attr('activeProfileValues') ? data.attr('activeProfileValues').split(';') : []);
						var activeProfileText  = (data.attr('activeProfileTexts')  ? data.attr('activeProfileTexts').split(';')  : []);
						if (activeProfileValue.includes(activeProfile)) activeProfile = activeProfileText[activeProfileValue.indexOf(activeProfile)]; %>
						<span class="label4value"><%= activeProfile %></span><br>
					<% } %>
					<% if (this.data.attr('oidWindowState')) {
						var windowState = vis.states.attr(this.data['oidWindowState'] + '.val').toString();
						var windowStateValue = (data.attr('windowStateValues') ? data.attr('windowStateValues').split(';') : []);
						var windowStateText  = (data.attr('windowStateTexts')  ? data.attr('windowStateTexts').split(';')  : []);
						if (windowStateValue.includes(windowState)) windowState = windowStateText[windowStateValue.indexOf(windowState)]; %>
						<span class="label5value"><%= windowState %></span><br>
					<% } %>
					<% if (this.data.attr('oidSetPointMode')) {
						var setpointMode = vis.states.attr(this.data['oidSetPointMode'] + '.val').toString();
						var setpointModeValue = (data.attr('setpointModeValues') ? data.attr('setpointModeValues').split(';') : []);
						var setpointModeText  = (data.attr('setpointModeTexts')  ? data.attr('setpointModeTexts').split(';')  : []);
						if (setpointModeValue.includes(setpointMode)) setpointMode = setpointModeText[setpointModeValue.indexOf(setpointMode)]; %>
						<span class="label6value"><%= setpointMode %></span>
					<% } %>
				<% } %>
			</div>
		</div>

		<div class="vis-widget-dialog <%== this.data.attr('class') %>" id="<%= this.data.attr('wid') %>_dialog" style="display:none" title="<%= this.data.attr('title') %>">

			<div class="thermostat head">
				<div class="actualTemperature"><span class="title"><%= this.data.attr('actualTemperatureLabel') %></span><span class="value"><%= vis.binds['vis-homekittiles'].formatValue(vis.states.attr(this.data['oidActualTemperature'] + '.val'), undefined, 1, this.data.attr('comma'), false) %><%= this.data.attr('unitTemperature') %></span></div>
			</div>

			<div class="thermostat content">
				<div class="values">
					<% if (this.data.attr('oidSetPointTemperature')) { %><div class="setpointTemperature"><span class="title"><%= this.data.attr('setpointTemperatureLabel') %></span><span class="value"><%= vis.binds['vis-homekittiles'].formatValue(vis.states.attr(this.data['oidSetPointTemperature'] + '.val'), undefined, 1, this.data.attr('comma'), false) %><%= this.data.attr('unitTemperature') %></span></div><% } %>
					<% if (this.data.attr('oidSetPointMode')) {
						var setpointMode = vis.states.attr(this.data['oidSetPointMode'] + '.val').toString();
						var setpointModeValue = (data.attr('setpointModeValues') ? data.attr('setpointModeValues').split(';') : []);
						var setpointModeText  = (data.attr('setpointModeTexts')  ? data.attr('setpointModeTexts').split(';')  : []);
						if (setpointModeValue.includes(setpointMode)) setpointMode = setpointModeText[setpointModeValue.indexOf(setpointMode)]; %>
						<div class="setpointMode <%= setpointMode %>"><span class="title"><%= this.data.attr('setpointModeLabel') %></span>
							<% if (this.data.attr('setpointModeOperable')) { %>
								<div class="selectMode">
									<select id="<%= this.data.attr('wid') %>_select" data-oid="<%= this.data.attr('oidSetPointMode') %>" data-view="<%= this.view %>" <%= (el) -> setTimeout(function () { vis.binds['vis-homekittiles'].multiselect(el)}, 250) %> >
										<%
										var values = (data.attr('setpointModeValues') ? data.attr('setpointModeValues').split(';') : []);
										var texts  = (data.attr('setpointModeTexts')  ? data.attr('setpointModeTexts').split(';')  : []);
										for (var val in values) { %>
											<option value="<%= values[val] %>"><%= texts[val] %></option>
										<% } %>
									</select >
								</div>
							<% } else { %>
								<span class="value"><%= setpointMode %></span></div>
							<% } %>
						</div>
					<% } %>
					<% if (this.data.attr('oidHumidity')) { %><div class="actualHumidity"><span class="title"><%= this.data.attr('actualHumidityLabel') %></span><span class="value"><%= vis.states.attr(this.data['oidHumidity'] + '.val') %><%= this.data.attr('unitHumidity') %></span></div><% } %>
					<% if (this.data.attr('oidActiveProfile')) {
						var activeProfile = vis.states.attr(this.data['oidActiveProfile'] + '.val').toString();
						var activeProfileValue = (data.attr('activeProfileValues') ? data.attr('activeProfileValues').split(';') : []);
						var activeProfileText  = (data.attr('activeProfileTexts')  ? data.attr('activeProfileTexts').split(';')  : []);
						if (activeProfileValue.includes(activeProfile)) activeProfile = activeProfileText[activeProfileValue.indexOf(activeProfile)]; %>
						<div class="activeProfile <%= activeProfile %>"><span class="title"><%= this.data.attr('activeProfileLabel') %></span>
							<div class="selectProfile">
								<select id="<%= this.data.attr('wid') %>_select" data-oid="<%= this.data.attr('oidActiveProfile') %>" data-view="<%= this.view %>" <%= (el) -> setTimeout(function () { vis.binds['vis-homekittiles'].multiselect(el)}, 250) %> >
									<%
									var values = (data.attr('activeProfileValues') ? data.attr('activeProfileValues').split(';') : []);
									var texts  = (data.attr('activeProfileTexts')  ? data.attr('activeProfileTexts').split(';')  : []);
									for (var val in values) { %>
										<option value="<%= values[val] %>"><%= texts[val] %></option>
									<% } %>
								</select >
							</div>
						</div>
					<% } %>
					<% if (this.data.attr('oidWindowState')) {
						var windowState = vis.states.attr(this.data['oidWindowState'] + '.val').toString();
						var windowStateValue = (data.attr('windowStateValues') ? data.attr('windowStateValues').split(';') : []);
						var windowStateText  = (data.attr('windowStateTexts')  ? data.attr('windowStateTexts').split(';')  : []);
						if (windowStateValue.includes(windowState)) windowState = windowStateText[windowStateValue.indexOf(windowState)]; %>
						<div class="windowState <%= windowState %>"><span class="title"><%= this.data.attr('windowStateLabel') %></span><span class="value"><%= windowState %></span></div>
					<% } %>
					<% if (this.data.attr('oidLowBat')) { %><div class="lowBat <%= vis.states.attr(this.data['oidLowBat'] + '.val') %>"><span class="value"><%= this.data.attr('lowBatLabel') %></span></div><% } %>
					<% if (this.data.attr('oidUnreach')) { %><div class="unreach <%= vis.states.attr(this.data['oidUnreach'] + '.val') %>"><span class="value"><%= this.data.attr('unreachLabel') %></span></div><% } %>
				</div>

				<% if (this.data.attr('oidSetPointTemperature')) { %>
					<div class="thermostatSlider">
						<div class="slider-container">
							<div class="slider" <%= (el) -> vis.binds['vis-homekittiles'].thermostatSlider(el, data, {orientation:"vertical"}) %>></div>
						</div>
					</div>
				<% } %>
			</div>

			<button class="button integratedClosebutton" <%= (el) -> vis.binds['vis-homekittiles'].dialogClose(el, {dialogWidgetId: data.attr('dialogWidgetId')}) %>><%== this.data.attr('closebuttonLabel') %></button>
		</div>

		<div class="blockOperation" <%= (el) -> vis.binds['vis-homekittiles'].addBlockOperation(el, data) %>></div>
		<div class="signals"><% for (let i = 1; i <= Number(this.data.attr("numberOfSignals")); i++) { %><div class="signal<%= i %>" data-oid="<%= this.data.attr('oidSignal' + i) %>" data-compOp="<%= this.data.attr('signalComparison' + i) %>" data-compVal="<%= this.data.attr('signalCompValue' + i) %>" data-icon="<%= this.data.attr('signalIcon' + i) %>" data-desc="<%= this.data.attr('signalDescription' + i) %>" <%= (el) -> vis.binds['vis-homekittiles'].addSignalIcon(el) %>></div><% } %></div>

		<div class="popup-helper" <%= (el) -> vis.binds['vis-homekittiles'].dialogThermostat(el, data) %> />
	</div>
</script>

<script id="tplHomekittilesSettingsBool"
	type="text/ejs"
	class="vis-tpl"
	data-vis-set="vis-homekittiles"
	data-vis-update-style="true"
	data-vis-type="ctrl"
	data-vis-name="hkt-Settings-Bool"
	data-vis-prev='<div id="prev_tplHomekittilesSettingsBool" style="position: relative;">
						<div class="vis-widget_prev" style="width: 110px; height: 17px; font-size:10px; font-weight: normal;">
							<div class="homekitTiles settings bool vis-widget-prev-body state-active">
								<label class="label">Switch</label>
								<div class="toggle"></div>
							</div>
						</div>
					</div>'
	data-vis-attrs="description/custom,vis-homekittiles.infoText,hktSettingsBool;oid/id;label[Switch];"
	data-vis-attrs0="group.blockOperation;blockOperationIfTrue/checkbox;blockOperationIfFalse/checkbox;blockOperationShowIcon/checkbox;blockOperationIcon/image;blockOperationIconNotInEditor/checkbox;blockOperationUseDifferentOID/checkbox;oidBlockOperation/id;"
>
	<div class="homekitTiles settings bool vis-widget <%= vis.states.attr(this.data['oid'] + '.val') ? 'state-active' : 'state-default' %> <%== this.data.attr('class') %>" style="width:230px; height:17px;" id="<%= this.data.attr('wid') %>">

		<div class="vis-widget-body" data-oid="<%= this.data.attr('oid') %>" <%= (el) -> vis.binds.basic.toggle(el); %>>
			<label class="label"><%= this.data.attr('label') %></label>
			<div class="toggle"></div>
		</div>

		<div class="invisible-helper" data-oid="<%= this.data.attr('oidBlockOperation') %>"></div>
		<%
		var blockOperationIfTrue = this.data.attr('blockOperationIfTrue');
		var blockOperationIfFalse = this.data.attr('blockOperationIfFalse');
		var blockOperationShowIcon = this.data.attr('blockOperationShowIcon');
		var currentState = false;
		var showBlockedIcon = false;

		//get value for blocked
		if (this.data.attr('blockOperationUseDifferentOID')) {
			var currentState = vis.states.attr(this.data['oidBlockOperation'] + '.val');
		} else {
			var currentState = vis.states.attr(this.data['oid'] + '.val');
		}

		//add blocked div
		if (blockOperationIfTrue && currentState == true || blockOperationIfFalse && currentState != true) { %>
			<div class="blockOperation" style="width: 100%; height:100%; position: absolute; top: 0; left: 0;"></div>
		<% }

		//add icon
		if (blockOperationShowIcon) {
			if (vis.editMode && !this.data.attr('blockOperationIconNotInEditor')) {
				showBlockedIcon = true;
			} else if (!vis.editMode && (blockOperationIfTrue && currentState || blockOperationIfFalse && !currentState)) {
				showBlockedIcon = true;
			}
			if (showBlockedIcon) { %>
				<img class="blockedIcon" src="<%= this.data.attr('blockOperationIcon') %>">
			<% }
		} %>
	</div>
</script>

<script id="tplHomekittilesSettingsValue"
	type="text/ejs"
	class="vis-tpl"
	data-vis-set="vis-homekittiles"
	data-vis-update-style="true"
	data-vis-type="ctrl"
	data-vis-name="hkt-Settings-Value"
	data-vis-prev='<div id="prev_tplHomekittilesSettingsValue" style="position: relative;">
						<div class="vis-widget_prev" style="width: 110px; height: 17px; font-size:10px; font-weight: normal;">
							<div class="homekitTiles settings value vis-widget-prev-body">
								<label class="label">Value</label>
								<div class="incrementMinus">-</div>
								<div class="value">12%</div>
								<div class="incrementPlus">+</div>
							</div>
						</div>
					</div>'
	data-vis-attrs="description/custom,vis-homekittiles.infoText,hktSettingsValue;oid/id;label[Value];unit;"
	data-vis-attrs0="group.increment;incrementPlusShow[true]/checkbox;incrementMinusShow[true]/checkbox;incrementPlusValue[1];incrementMinusValue[-1];incrementValueMax[100];incrementValueMin[0];"
	data-vis-attrs1="group.blockOperation;blockOperationIfTrue/checkbox;blockOperationIfFalse/checkbox;blockOperationShowIcon/checkbox;blockOperationIcon/image;blockOperationIconNotInEditor/checkbox;blockOperationUseDifferentOID/checkbox;oidBlockOperation/id;"
>
	<div class="homekitTiles settings value vis-widget <%== this.data.attr('class') %>" style="width:230px; height:17px;" id="<%= this.data.attr('wid') %>">

		<div class="vis-widget-body" data-oid="<%= this.data.attr('oid') %>">
			<label class="label"><%= this.data.attr('label') %></label>

			<% if (this.data.attr('incrementMinusShow')) { %>
				<div class="incrementMinus"
					data-oid="<%= this.data.attr('oid') %>"
					data-vis-step="<%= this.data.attr('incrementMinusValue') %>"
					data-val="<%= this.data.attr('oid') %>"
					<%= (el) -> vis.binds.basic.increment(el,data.incrementValueMin)%>
				>-</div>
			<% } %>

			<div class="value">
				<%== vis.states.attr(this.data['oid'] + '.val') %><%= this.data.attr('unit') %>
			</div>

			<% if (this.data.attr('incrementPlusShow')) { %>
				<div class="incrementPlus"
					data-oid="<%= this.data.attr('oid') %>"
					data-vis-step="<%= this.data.attr('incrementPlusValue') %>"
					data-val="<%= this.data.attr('oid') %>"
					<%= (el) -> vis.binds.basic.increment(el,data.incrementValueMax)%>
				>+</div>
			<% } %>
		</div>

		<div class="invisible-helper" data-oid="<%= this.data.attr('oidBlockOperation') %>"></div>
		<%
		var blockOperationIfTrue = this.data.attr('blockOperationIfTrue');
		var blockOperationIfFalse = this.data.attr('blockOperationIfFalse');
		var blockOperationShowIcon = this.data.attr('blockOperationShowIcon');
		var currentState = false;
		var showBlockedIcon = false;

		//get value for blocked
		if (this.data.attr('blockOperationUseDifferentOID')) {
			var currentState = vis.states.attr(this.data['oidBlockOperation'] + '.val');
		} else {
			var currentState = vis.states.attr(this.data['oid'] + '.val');
		}

		//add blocked div
		if (blockOperationIfTrue && currentState == true || blockOperationIfFalse && currentState != true) { %>
			<div class="blockOperation" style="width: 100%; height:100%; position: absolute; top: 0; left: 0;"></div>
		<% }

		//add icon
		if (blockOperationShowIcon) {
			if (vis.editMode && !this.data.attr('blockOperationIconNotInEditor')) {
				showBlockedIcon = true;
			} else if (!vis.editMode && (blockOperationIfTrue && currentState || blockOperationIfFalse && !currentState)) {
				showBlockedIcon = true;
			}
			if (showBlockedIcon) { %>
				<img class="blockedIcon" src="<%= this.data.attr('blockOperationIcon') %>">
			<% }
		} %>
	</div>
</script>

<script id="tplHomekittilesSettingsSelect"
	type="text/ejs"
	class="vis-tpl"
	data-vis-set="vis-homekittiles"
	data-vis-update-style="true"
	data-vis-type="ctrl"
	data-vis-name="hkt-Settings-Select"
	data-vis-prev='<div id="prev_tplHomekittilesSettingsSelect" style="position: relative;">
						<div class="vis-widget_prev" style="width: 110px; height: 17px; font-size:10px; font-weight: normal;">
							<div class="homekitTiles settings select vis-widget-prev-body">
								<label class="label">Select</label>
								<select>
									<option value="Auto">Auto</option>
								</select>
							</div>
						</div>
					</div>'
	data-vis-attrs="description/custom,vis-homekittiles.infoText,hktSettingsSelect;oid/id;label[Select];"
	data-vis-attrs0="group.select;values[0Â§1Â§2]/text;texts[OFFÂ§ONÂ§AUTO]/text;"
	data-vis-attrs1="group.blockOperation;blockOperationIfTrue/checkbox;blockOperationIfFalse/checkbox;blockOperationShowIcon/checkbox;blockOperationIcon/image;blockOperationIconNotInEditor/checkbox;blockOperationUseDifferentOID/checkbox;oidBlockOperation/id;"
>
	<div class="homekitTiles settings select vis-widget <%== this.data.attr('class') %>" style="width:230px; height:17px;" id="<%= this.data.attr('wid') %>">
		<div class="vis-widget-body">
			<label class="label"><%= this.data.attr('label') %></label>

			<select id="<%= this.data.attr('wid') %>_select" data-oid="<%= this.data.attr('oid') %>" data-view="<%= this.view %>" <%= (el) -> setTimeout(function () { vis.binds['vis-homekittiles'].multiselect(el)}, 250) %> >
			<%
				var values = (data.attr('values') ? data.attr('values').split(';') : []);
				var texts  = (data.attr('texts')  ? data.attr('texts').split(';')  : []);
				for (var val in values) {
					%>
					<option value="<%= values[val] %>"><%= texts[val] %></option>
					<%
				}
			%>
			</select >
		</div>

		<div class="invisible-helper" data-oid="<%= this.data.attr('oidBlockOperation') %>"></div>
		<%
		var blockOperationIfTrue = this.data.attr('blockOperationIfTrue');
		var blockOperationIfFalse = this.data.attr('blockOperationIfFalse');
		var blockOperationShowIcon = this.data.attr('blockOperationShowIcon');
		var currentState = false;
		var showBlockedIcon = false;

		//get value for blocked
		if (this.data.attr('blockOperationUseDifferentOID')) {
			var currentState = vis.states.attr(this.data['oidBlockOperation'] + '.val');
		} else {
			var currentState = vis.states.attr(this.data['oid'] + '.val');
		}

		//add blocked div
		if (blockOperationIfTrue && currentState == true || blockOperationIfFalse && currentState != true) { %>
			<div class="blockOperation" style="width: 100%; height:100%; position: absolute; top: 0; left: 0;"></div>
		<% }

		//add icon
		if (blockOperationShowIcon) {
			if (vis.editMode && !this.data.attr('blockOperationIconNotInEditor')) {
				showBlockedIcon = true;
			} else if (!vis.editMode && (blockOperationIfTrue && currentState || blockOperationIfFalse && !currentState)) {
				showBlockedIcon = true;
			}
			if (showBlockedIcon) { %>
				<img class="blockedIcon" src="<%= this.data.attr('blockOperationIcon') %>">
			<% }
		} %>
	</div>
</script>

<script id="tplHomekittilesButtonDialogClose"
	type="text/ejs"
	class="vis-tpl"
	data-vis-set="vis-homekittiles"
	data-vis-update-style="true"
	data-vis-type="dialog"
	data-vis-name="hkt-Button-DialogClose"
	data-vis-prev='<div id="prev_tplHomekittilesButtonDialogClose" style="position: relative;">
						<div class="vis-widget_prev" style="width:110px; height:25px; font-weight: normal;">
							<div class="homekitTiles button dialogClose vis-widget-prev-body">
								<div class="button" style="font-size:12px; display: flex; align-items: center; justify-content: center;">Close dialog</div>
							</div>
						</div>
					</div>'
	data-vis-attrs="description/custom,vis-homekittiles.infoText,hktButtonDialogClose;label[Close dialog];dialogWidgetId;">
	<div class="homekitTiles button dialogClose vis-widget <%== this.data.attr('class') %>" style="width:200px; height:50px;" id="<%= this.data.attr('wid') %>">
		<div class="vis-widget-body">
			<button class="button" <%= (el) -> vis.binds['vis-homekittiles'].dialogClose(el, {dialogWidgetId: data.attr('dialogWidgetId')}) %>><%== this.data.attr('label') %></button>
		</div>
	</div>
</script>

<script id="tplHomekittilesButtonSet"
	type="text/ejs"
	class="vis-tpl"
	data-vis-set="vis-homekittiles"
	data-vis-update-style="true"
	data-vis-type="ctrl"
	data-vis-name="hkt-Button-Set"
	data-vis-prev='<div id="prev_tplHomekittilesButtonSet" style="position: relative;">
						<div class="vis-widget_prev" style="width:110px; height:25px; font-weight: normal;">
							<div class="homekitTiles button button-set vis-widget-prev-body" style="display: flex; flex-direction: row;">
								<div class="button button-set button-1" style="font-size:12px; display: flex; align-items: center; justify-content: center;">Button 1</div>
								<div class="button button-set button-2" style="font-size:12px; display: flex; align-items: center; justify-content: center;">Button n</div>
							</div>
						</div>
					</div>'
	data-vis-attrs="description/custom,vis-homekittiles.infoText,hktButtonSet;numberOfButtons[2]/slider,1,10,1;"
	data-vis-attrs0="group.buttons/byindex;oid_(1-numberOfButtons)/id;label_(1-numberOfButtons)[Button];value_(1-numberOfButtons);closeDialog_(1-numberOfButtons)/checkbox;"
>
	<div class="homekitTiles button button-set vis-widget <%== this.data.attr('class') %>" style="width:400px; height:50px;" id="<%= this.data.attr('wid') %>">
		<div class="vis-widget-body" >

			<%
			var numberOfButtons = Number(this.data.attr("numberOfButtons"));
			var wid = data.attr('wid');
			var i = 1;

			while (i <= numberOfButtons) {
				var oid = this.data.attr('oid_' + i);
				var value = this.data.attr('value_' + i);
				var label = this.data.attr('label_' + i);
				var closeDialog = this.data.attr('closeDialog_' + i);
				var wid = data.attr('wid');

				if (closeDialog) {
					%>
					<button class="button button-set button-<%= i %>" data-oid="<%= oid %>" data-val="<%= value %>" id="<%= wid %>_button<%= i %>" <%= (el) -> vis.binds.basic.state(el); %><%= (el) -> vis.binds['vis-homekittiles'].dialogClose(el, {dialogWidgetId: ''}); %>><%= label %></button>
					<%
				} else {
					%>
					<button class="button button-set button-<%= i %>" data-oid="<%= oid %>" data-val="<%= value %>" id="<%= wid %>_button<%= i %>" <%= (el) -> vis.binds.basic.state(el); %>><%= label %></button>
					<%
				}
				i++;
			} %>
		</div>
	</div>
</script>

<script id="tplHomekittilesButtonSetNavigation"
	type="text/ejs"
	class="vis-tpl"
	data-vis-set="vis-homekittiles"
	data-vis-update-style="true"
	data-vis-type="ctrl"
	data-vis-name="hkt-Button-Set-Navigation"
	data-vis-prev='<div id="prev_tplHomekittilesButtonSetNavigation" style="position: relative;">
						<div class="vis-widget_prev" style="width:110px; height:25px; font-weight: normal;">
							<div class="homekitTiles navigationbuttonset vis-widget-prev-body" style="display: flex; flex-direction: row;">
								<div class="navigationbutton" style="width: 50%">
									<label style="width: 100%; text-align: center;">View 1</label>
								</div>
								<div class="navigationbutton" style="width: 50%; border-left: 1px solid">
									<label style="width: 100%; text-align: center;">View 2</label>
								</div>
							</div>
						</div>
					</div>'
	data-vis-attrs="description/custom,vis-homekittiles.infoText,hktButtonSetNavigation;numberOfButtons[3]/slider,1,10,1;directionHorizontal[true]/checkbox;"
	data-vis-attrs0="group.buttons/byindex;
					view_(1-numberOfButtons)/views;
					icon_(1-numberOfButtons)/image;
					label_(1-numberOfButtons)[View];
					showNotifications(1-numberOfButtons)/checkbox;
					notification1oid(1-numberOfButtons)/id;
					notification2oid(1-numberOfButtons)/id;
					notification3oid(1-numberOfButtons)/id;
					notification4oid(1-numberOfButtons)/id;
					notification5oid(1-numberOfButtons)/id;
					notification1showZero(1-numberOfButtons)/checkbox;
					notification2showZero(1-numberOfButtons)/checkbox;
					notification3showZero(1-numberOfButtons)/checkbox;
					notification4showZero(1-numberOfButtons)/checkbox;
					notification5showZero(1-numberOfButtons)/checkbox;"
>
	<%
	var width = 0;
	var height = 0;
	if (this.data.attr('directionHorizontal')) {
		width = this.data.attr('numberOfButtons') * 120;
		height = 30;
	} else {
		width = 120;
		height = this.data.attr('numberOfButtons') * 30
	}
	%>
	<div class="homekitTiles navigationbuttonset vis-widget <%== this.data.attr('class') %>" style="width: <%= width %>px; height:<%= height %>px" id="<%= this.data.attr('wid') %>">
		<div class="vis-widget-body <%= this.data.attr('directionHorizontal') ? 'horizontal' : 'vertical' %>">

			<%
			var numberOfButtons = Number(this.data.attr("numberOfButtons"));
			var wid = data.attr('wid');
			var i = 1;

			while (i <= numberOfButtons) {
				var view = this.data.attr('view_' + i);
				var icon = this.data.attr('icon_' + i);
				var label = this.data.attr('label_' + i);
				var showNotifications = this.data.attr('showNotifications' + i);

				%>
				<div data-vis-nav="<%= view %>" class="navigationbutton navigationbutton-<%= i %> hkt-nav-state state-default" <%= (el) -> vis.binds['vis-homekittiles'].hktNavigationActive(el); vis.binds['vis-homekittiles'].hktNavigation(el); %>>
					<div class="navigationbutton">

						<% if (icon !== '' && icon !== undefined) { %>
							<img src="<%= icon %>" />
						<% } %>

						<label><%= label %></label>
					</div>

					<%
					if (showNotifications) {
						var notification1oid      = 'notification1oid' + i;
						var notification2oid      = 'notification2oid' + i;
						var notification3oid      = 'notification3oid' + i;
						var notification4oid      = 'notification4oid' + i;
						var notification5oid      = 'notification5oid' + i;
						var notification1showZero = 'notification1showZero' + i;
						var notification2showZero = 'notification2showZero' + i;
						var notification3showZero = 'notification3showZero' + i;
						var notification4showZero = 'notification4showZero' + i;
						var notification5showZero = 'notification5showZero' + i;

						%>
						<div class="notifications">
							<div class="notification">
								<%
								valNotification1 = vis.states.attr(this.data[notification1oid] + '.val');
								if (valNotification1 === undefined || valNotification1 === '') valNotification1 = 0;

								if (vis.editMode || valNotification1 !== 0 && valNotification1 !== '0' || (valNotification1 == 0 || valNotification1 == '0') && this.data.attr(notification1showZero)) { %>
									<span class="notification1" ><%=valNotification1%></span>
								<% } %>
							</div>
							<div class="notification">
								<%
								valNotification2 = vis.states.attr(this.data[notification2oid] + '.val');
								if (valNotification2 === undefined || valNotification2 === '') valNotification2 = 0;

								if (vis.editMode || valNotification2 !== 0 && valNotification2 !== '0' || (valNotification2 == 0 || valNotification2 == '0') && this.data.attr(notification2showZero)) { %>
									<span class="notification2" ><%=valNotification2%></span>
								<% } %>
							</div>
							<div class="notification">
								<%
								valNotification3 = vis.states.attr(this.data[notification3oid] + '.val');
								if (valNotification3 === undefined || valNotification3 === '') valNotification3 = 0;

								if (vis.editMode || valNotification3 !== 0 && valNotification3 !== '0' || (valNotification3 == 0 || valNotification3 == '0') && this.data.attr(notification3showZero)) { %>
									<span class="notification3" ><%=valNotification3%></span>
								<% } %>
							</div>
							<div class="notification">
								<%
								valNotification4 = vis.states.attr(this.data[notification4oid] + '.val');
								if (valNotification4 === undefined || valNotification4 === '') valNotification4 = 0;

								if (vis.editMode || valNotification4 !== 0 && valNotification4 !== '0' || (valNotification4 == 0 || valNotification4 == '0') && this.data.attr(notification4showZero)) { %>
									<span class="notification4" ><%=valNotification4%></span>
								<% } %>
							</div>
							<div class="notification">
								<%
								valNotification5 = vis.states.attr(this.data[notification5oid] + '.val');
								if (valNotification5 === undefined || valNotification5 === '') valNotification5 = 0;

								if (vis.editMode || valNotification5 !== 0 && valNotification5 !== '0' || (valNotification5 == 0 || valNotification5 == '0') && this.data.attr(notification5showZero)) { %>
									<span class="notification5" ><%=valNotification5%></span>
								<% } %>
							</div>
						</div>
					<% } %>
				</div>
				<%

				i++;
			} %>
		</div>
	</div>
</script>

<script id="tplHomekittilesViewInWidgetSwipe"
	type="text/ejs"
	class="vis-tpl"
	data-vis-set="vis-homekittiles"
	data-vis-update-style="true"
	data-vis-type="container"
	data-vis-name="hkt-ViewInWidget-Swipe"
	data-vis-prev='<div id="prev_tplHomekittilesViewInWidgetSwipe" style="position: relative;">
						<div class="vis-widget_prev" style="width: 110px; height: 55px; font-size:10px; font-weight: normal;">
							<div class="homekitTiles vis-widget-prev-body" style="display: flex; color: var(--hkt-color-settings-text);">
								<div style="width: 49%; height: 96%; border: 1px solid; display: flex; align-items: center; justify-content: center;">View 1</div>
								<div style="width: 49%; height: 96%; border: 1px solid; display: flex; align-items: center; justify-content: center;">View 2</div>
							</div>
						</div>
					</div>'
	data-vis-attrs="description/custom,vis-homekittiles.infoText,hktViewInWidgetSwipe;numberOfViews[2]/slider,2,10,1;"
	data-vis-attrs0="group.views;view_(1-numberOfViews)/views;"
>
	<div class="homekitTiles viewInWidget swipe vis-widget <%== this.data.attr('class') %>" style="width:235px; height:235px;" id="<%= this.data.attr('wid') %>">
		<% if (vis.editMode) { %>
			<div class="editmode-helper"></div>
		<% } %>

		<%
		var numberOfViews = Number(this.data.attr("numberOfViews"));
		var i = 1;
		while (i <= numberOfViews) {	%>
			<div data-vis-contains="<%= this.data.attr('view_' + i) %>" class="vis-view-container subview"></div>
			<%
			i++;
		} %>
	</div>
</script>